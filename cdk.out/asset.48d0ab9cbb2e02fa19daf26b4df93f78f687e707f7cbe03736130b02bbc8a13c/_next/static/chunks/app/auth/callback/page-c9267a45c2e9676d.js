(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[769],{447:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>s});var a=o(5155),r=o(2115),n=o(5695),c=o(9323);function i(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)();return(0,r.useEffect)(()=>{let o=t.get("code");(async()=>{try{o&&await (0,c.R$)(o),(0,c.dZ)(),e.replace("/dashboard")}catch(t){e.replace("/login")}})()},[e,t]),null}function s(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(i,{})})}},4850:(e,t,o)=>{Promise.resolve().then(o.bind(o,447))},5695:(e,t,o)=>{"use strict";var a=o(8999);o.o(a,"useParams")&&o.d(t,{useParams:function(){return a.useParams}}),o.o(a,"useRouter")&&o.d(t,{useRouter:function(){return a.useRouter}}),o.o(a,"useSearchParams")&&o.d(t,{useSearchParams:function(){return a.useSearchParams}})},9323:(e,t,o)=>{"use strict";o.d(t,{CI:()=>_,Ht:()=>u,O3:()=>d,R$:()=>l,c$:()=>s,dZ:()=>function e(){let t=Number(localStorage.getItem("token_expires_at")||"0");if(!t)return;let o=1e3*t-Date.now()-6e4;o<=0||setTimeout(async()=>{try{await d()}catch(e){}e()},o)}});let a="rollout-016442247702-us-west-2.auth.us-west-2.amazoncognito.com",r="1m9ih2q5074gl4cuhvb64hfnta",n="https://".concat(a,"/oauth2/token");function c(e){return btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function i(e){let t=new TextEncoder().encode(e);return c(await crypto.subtle.digest("SHA-256",t))}async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=c(crypto.getRandomValues(new Uint8Array(32)).buffer),o=await i(t);localStorage.setItem("pkce_verifier",t);let n=new URLSearchParams({client_id:r,response_type:"code",scope:"openid email profile",redirect_uri:"".concat(window.location.origin,"/auth/callback/"),code_challenge_method:"S256",code_challenge:o});e.signup&&n.set("screen_hint","signup"),e.idp&&n.set("identity_provider",e.idp),window.location.href="https://".concat(a,"/oauth2/authorize?").concat(n.toString())}async function l(e){let t=new URLSearchParams({grant_type:"authorization_code",client_id:r,code:e,code_verifier:localStorage.getItem("pkce_verifier")||"",redirect_uri:"".concat(window.location.origin,"/auth/callback/")}),o=await fetch(n,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:t});if(!o.ok)throw Error("Token exchange failed");let a=await o.json(),c=Math.floor(Date.now()/1e3)+(a.expires_in||3600);localStorage.setItem("id_token",a.id_token),localStorage.setItem("access_token",a.access_token),localStorage.setItem("refresh_token",a.refresh_token||""),localStorage.setItem("token_expires_at",String(c))}function u(){return{idToken:localStorage.getItem("id_token")||void 0,accessToken:localStorage.getItem("access_token")||void 0}}async function d(){let e=localStorage.getItem("refresh_token");if(!e)return!1;let t=new URLSearchParams({grant_type:"refresh_token",client_id:r,refresh_token:e}),o=await fetch(n,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:t});if(!o.ok)return!1;let a=await o.json(),c=Math.floor(Date.now()/1e3)+(a.expires_in||3600);return a.id_token&&localStorage.setItem("id_token",a.id_token),a.access_token&&localStorage.setItem("access_token",a.access_token),localStorage.setItem("token_expires_at",String(c)),!0}function _(){localStorage.removeItem("id_token"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("token_expires_at");let e=new URLSearchParams({client_id:r,logout_uri:"".concat(window.location.origin,"/")});window.location.href="https://".concat(a,"/logout?").concat(e.toString())}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(4850)),_N_E=e.O()}]);